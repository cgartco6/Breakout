<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypto Intelligence Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
        :root {
            --primary: #1a1b2d;
            --secondary: #25273d;
            --accent: #4cc9f0;
            --accent2: #f72585;
            --text: #edf2f4;
            --text-secondary: #8d99ae;
            --success: #72e128;
            --warning: #ff9e00;
            --danger: #ef233c;
            --card-bg: #2b2d42;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, var(--primary), #0d0e1b);
            color: var(--text);
            min-height: 100vh;
            padding-bottom: 20px;
        }
        
        .container {
            width: 95%;
            max-width: 1800px;
            margin: 0 auto;
        }
        
        header {
            background: linear-gradient(90deg, var(--secondary), var(--primary));
            padding: 15px 0;
            border-bottom: 1px solid rgba(76, 201, 240, 0.3);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .logo h1 {
            font-size: 1.8rem;
            background: linear-gradient(45deg, var(--accent), var(--accent2));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 700;
        }
        
        .logo-icon {
            font-size: 2rem;
            color: var(--accent);
        }
        
        .ticker-container {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 5px;
            padding: 10px 15px;
            overflow: hidden;
            position: relative;
            width: 65%;
            height: 40px;
        }
        
        .ticker-scroll {
            display: flex;
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            align-items: center;
        }
        
        .ticker-item {
            display: flex;
            align-items: center;
            margin-right: 30px;
            white-space: nowrap;
        }
        
        .ticker-symbol {
            font-weight: bold;
            margin-right: 5px;
        }
        
        .ticker-price {
            margin-right: 15px;
        }
        
        .price-up {
            color: var(--success);
        }
        
        .price-down {
            color: var(--danger);
        }
        
        .last-updated {
            font-size: 0.8rem;
            color: var(--text-secondary;
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        @media (max-width: 1200px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
        }
        
        .card {
            background: var(--card-bg);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.25);
            transition: transform 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(141, 153, 174, 0.3);
        }
        
        .card-title {
            font-size: 1.4rem;
            color: var(--accent);
            margin: 0;
        }
        
        .status {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        .status-live {
            background-color: var(--success);
            color: #000;
        }
        
        .coin-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .coin-card {
            background: linear-gradient(145deg, var(--secondary), var(--primary));
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .coin-card:hover {
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .coin-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--accent), var(--accent2));
        }
        
        .coin-name {
            font-size: 1.2rem;
            margin: 10px 0 5px;
            color: var(--accent);
        }
        
        .coin-price {
            font-size: 1.3rem;
            font-weight: bold;
            color: var(--text);
            margin-bottom: 5px;
        }
        
        .price-change {
            font-size: 0.9rem;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .prediction-bullish {
            color: var(--success);
        }
        
        .prediction-bearish {
            color: var(--danger);
        }
        
        .signal {
            padding: 8px;
            border-radius: 6px;
            margin: 8px 0;
            font-size: 0.9rem;
        }
        
        .signal-buy {
            background-color: rgba(114, 225, 40, 0.15);
            border-left: 3px solid var(--success);
        }
        
        .signal-sell {
            background-color: rgba(239, 35, 60, 0.15);
            border-left: 3px solid var(--danger);
        }
        
        .signal-hold {
            background-color: rgba(255, 158, 0, 0.15);
            border-left: 3px solid var(--warning);
        }
        
        .signal-strong-buy {
            background: linear-gradient(90deg, rgba(114, 225, 40, 0.2), transparent);
            border-left: 3px solid var(--success);
            animation: pulse 2s infinite;
        }
        
        .progress-container {
            background-color: var(--secondary);
            border-radius: 5px;
            height: 10px;
            margin: 15px 0;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            border-radius: 5px;
            background: linear-gradient(90deg, var(--accent), var(--accent2));
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            color: var(--text-secondary);
        }
        
        input, select {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--secondary);
            border-radius: 5px;
            background-color: rgba(0, 0, 0, 0.2);
            color: var(--text);
        }
        
        button {
            background: linear-gradient(90deg, var(--accent), var(--accent2));
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        button:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }
        
        .influencer-section {
            display: flex;
            overflow-x: auto;
            gap: 15px;
            padding: 10px 0;
            margin-bottom: 20px;
        }
        
        .influencer-card {
            min-width: 200px;
            background: linear-gradient(145deg, var(--secondary), var(--primary));
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }
        
        .influencer-name {
            font-size: 1.1rem;
            margin: 10px 0 5px;
            color: var(--accent);
        }
        
        .accuracy-badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 12px;
            background-color: var(--accent);
            color: white;
            font-size: 0.8rem;
            margin-top: 10px;
        }
        
        .system-health {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid rgba(141, 153, 174, 0.3);
        }
        
        .health-item {
            text-align: center;
            flex: 1;
        }
        
        .health-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--success);
        }
        
        footer {
            text-align: center;
            padding: 20px 0;
            margin-top: 40px;
            color: var(--text-secondary);
            font-size: 0.9rem;
            border-top: 1px solid rgba(141, 153, 174, 0.3);
        }
        
        .tab-container {
            margin: 20px 0;
        }
        
        .tabs {
            display: flex;
            border-bottom: 1px solid rgba(141, 153, 174, 0.3);
            margin-bottom: 20px;
        }
        
        .tab {
            padding: 12px 24px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
        }
        
        .tab.active {
            border-bottom: 3px solid var(--accent);
            color: var(--accent);
        }
        
        .tab-content {
            display: none;
            padding: 20px 0;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px;
            border-radius: 5px;
            background-color: var(--card-bg);
            color: var(--text);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            transform: translateX(100%);
            transition: transform 0.3s ease;
            z-index: 1000;
            max-width: 350px;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification.success {
            border-left: 4px solid var(--success);
        }
        
        .notification.error {
            border-left: 4px solid var(--danger);
        }
        
        .chart-container {
            height: 400px;
            margin-top: 20px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid rgba(141, 153, 174, 0.3);
        }
        
        th {
            color: var(--accent);
        }
        
        .gainers-losers {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        @keyframes ticker-scroll {
            0% { transform: translateX(0); }
            100% { transform: translateX(-100%); }
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 15px;
            }
            
            .ticker-container {
                width: 100%;
            }
            
            .coin-grid {
                grid-template-columns: 1fr;
            }
            
            .tabs {
                overflow-x: auto;
                white-space: nowrap;
            }
            
            .gainers-losers {
                grid-template-columns: 1fr;
            }
        }
        
        .loader {
            border: 3px solid var(--secondary);
            border-top: 3px solid var(--accent);
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-left: 10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .api-status {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
            font-size: 0.8rem;
        }
        
        .api-status-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            display: inline-block;
        }
        
        .api-status-live {
            background-color: var(--success);
        }
        
        .api-status-offline {
            background-color: var(--danger);
        }
        
        .api-key-form {
            background: var(--secondary);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .api-key-form h3 {
            margin-bottom: 15px;
            color: var(--accent);
        }
        
        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .form-row .form-group {
            flex: 1;
            margin-bottom: 0;
        }
        
        .data-source {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-brain logo-icon"></i>
                    <h1>SynthIntelligence Crypto</h1>
                </div>
                <div class="ticker-container">
                    <div class="ticker-scroll" id="tickerScroll">
                        <!-- Ticker items will be dynamically added here -->
                    </div>
                </div>
                <div class="last-updated" id="lastUpdated">UTC: <span id="updateTime">Loading...</span></div>
            </div>
        </div>
    </header>

    <div class="container">
        <div class="api-key-form">
            <h3>API Configuration</h3>
            <div class="form-row">
                <div class="form-group">
                    <label for="cmcApiKey">CoinMarketCap API Key</label>
                    <input type="text" id="cmcApiKey" placeholder="Enter your CMC API key">
                    <div class="data-source">Required for accurate data</div>
                </div>
                <div class="form-group">
                    <label for="cgApiKey">CoinGecko API Key (Optional)</label>
                    <input type="text" id="cgApiKey" placeholder="Enter your CG API key">
                    <div class="data-source">Fallback data source</div>
                </div>
            </div>
            <button id="saveApiKeys">Save API Keys</button>
        </div>
        
        <div class="dashboard">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">BTC Dominance & Market Overview</h2>
                    <span class="status status-live">LIVE</span>
                </div>
                <div class="progress-container">
                    <div class="progress-bar" id="btcDominanceBar" style="width: 0%;"></div>
                </div>
                <p>BTC Dominance: <span id="btcDominanceValue">Loading...</span></p>
                <p>Total Market Cap: <span id="totalMarketCap">Loading...</span></p>
                <p>Market Sentiment: <span id="marketSentiment">Loading...</span></p>
                <p>24h Volume: <span id="marketVolume">Loading...</span></p>
                <div class="api-status">
                    <span class="api-status-indicator api-status-live" id="cmcStatus"></span>
                    <span>CoinMarketCap API: <span id="cmcStatusText">Live</span></span>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">System Health & Accuracy</h2>
                    <span class="status status-live">OPTIMAL</span>
                </div>
                <p>AI Prediction Accuracy: <span id="aiAccuracy">87.3%</span></p>
                <p>Self-Healing Agent: <span id="healingStatus">Active</span></p>
                <p>Data Feed Integrity: <span id="dataIntegrity">99.9%</span></p>
                <p>Last System Update: <span id="systemUpdate">Today, 09:42 AM</span></p>
                <div class="system-health">
                    <div class="health-item">
                        <div>Uptime</div>
                        <div class="health-value">99.9%</div>
                    </div>
                    <div class="health-item">
                        <div>Latency</div>
                        <div class="health-value">12ms</div>
                    </div>
                    <div class="health-item">
                        <div>Version</div>
                        <div class="health-value">2.3.5</div>
                    </div>
                </div>
                <div class="api-status">
                    <span class="api-status-indicator api-status-live" id="cgStatus"></span>
                    <span>CoinGecko API: <span id="cgStatusText">Live</span></span>
                </div>
            </div>
        </div>
        
        <div class="gainers-losers">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Biggest Gainers (24h)</h2>
                </div>
                <div id="gainersList">
                    <!-- Gainers will be populated here -->
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Biggest Losers (24h)</h2>
                </div>
                <div id="losersList">
                    <!-- Losers will be populated here -->
                </div>
            </div>
        </div>
        
        <div class="tab-container">
            <div class="tabs">
                <div class="tab active" data-tab="monitored">Tracked Altcoins</div>
                <div class="tab" data-tab="predictions">Breakout Predictions</div>
                <div class="tab" data-tab="influencers">Influencer Impact</div>
                <div class="tab" data-tab="custom">Custom Watchlist</div>
            </div>
            
            <div class="tab-content active" id="monitored">
                <h3>AI-Monitored Altcoin Performance</h3>
                <div class="coin-grid" id="monitoredCoinsGrid">
                    <!-- Monitored coins will be populated here -->
                </div>
                
                <h3>Price Performance Charts</h3>
                <div class="chart-container">
                    <canvas id="priceChart"></canvas>
                </div>
            </div>
            
            <div class="tab-content" id="predictions">
                <h3>Early Breakout Predictions</h3>
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Next 7-14 Day Breakout Candidates</h2>
                    </div>
                    <div id="breakoutPredictions">
                        <!-- Breakout predictions will be populated here -->
                    </div>
                </div>
                
                <h3>Prediction Timeframes</h3>
                <div class="card">
                    <table id="predictionTimeframes">
                        <thead>
                            <tr>
                                <th>Coin</th>
                                <th>Buy Window</th>
                                <th>Sell Target</th>
                                <th>Timeframe</th>
                                <th>Confidence</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Prediction timeframes will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div class="tab-content" id="influencers">
                <h3>Influencer Impact Analysis</h3>
                <div class="influencer-section" id="influencerCards">
                    <!-- Influencer cards will be populated here -->
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Influencer Sentiment Analysis</h2>
                    </div>
                    <div id="influencerSentiment">
                        <!-- Influencer sentiment will be populated here -->
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="custom">
                <h3>Custom Coin Watchlist</h3>
                <div class="card">
                    <div class="form-group">
                        <label for="customCoin">Add Coin to Monitor (Symbol):</label>
                        <input type="text" id="customCoin" placeholder="e.g. ETH, SOL, DOT">
                    </div>
                    <button id="addCoinBtn">Add Coin</button>
                </div>
                
                <div id="customCoinsContainer">
                    <h4>Your Watched Coins</h4>
                    <div id="customCoinsList" class="coin-grid">
                        <!-- Custom coins will be populated here -->
                    </div>
                </div>
                
                <div class="chart-container">
                    <canvas id="customChart"></canvas>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <div class="container">
            <p>Synthetic Intelligence Altcoin Prediction System | Version 2.3.5 | Self-Healing AI Architecture</p>
            <p>This is a simulation for educational purposes only. Not financial advice.</p>
        </div>
    </footer>

    <div class="notification" id="notification">
        <div id="notificationMessage"></div>
    </div>

    <script>
        // Initialize variables and state
        const monitoredCoins = ['WIF', 'FIL', 'BONK', 'ADA', 'XMR', 'TRX'];
        const topCoins = ['BTC', 'ETH', 'BNB', 'SOL', 'XRP', 'DOGE', 'ADA', 'AVAX', 'DOT', 'LINK', 'MATIC', 'SHIB', 'BCH', 'LTC'];
        let customCoins = [];
        let priceChart, customChart;
        let coinData = {};
        let cmcApiKey = '';
        let cgApiKey = '';
        let dataSource = 'CoinGecko'; // Default data source
        
        // DOM Ready
        document.addEventListener('DOMContentLoaded', function() {
            // Load saved API keys
            const savedCmcApiKey = localStorage.getItem('cmcApiKey');
            const savedCgApiKey = localStorage.getItem('cgApiKey');
            
            if (savedCmcApiKey) {
                document.getElementById('cmcApiKey').value = savedCmcApiKey;
                cmcApiKey = savedCmcApiKey;
                dataSource = 'CoinMarketCap';
            }
            
            if (savedCgApiKey) {
                document.getElementById('cgApiKey').value = savedCgApiKey;
                cgApiKey = savedCgApiKey;
            }
            
            initializeTicker();
            initializeCharts();
            setupEventListeners();
            startDataFeed();
            updateSystemStatus();
            
            // Fetch initial data
            fetchMarketData();
            fetchCoinData();
        });
        
        // Initialize price ticker
        function initializeTicker() {
            const tickerScroll = document.getElementById('tickerScroll');
            tickerScroll.innerHTML = '';
            
            topCoins.forEach(coin => {
                const tickerItem = document.createElement('div');
                tickerItem.className = 'ticker-item';
                tickerItem.id = `ticker-${coin}`;
                
                tickerItem.innerHTML = `
                    <span class="ticker-symbol">${coin}</span>
                    <span class="ticker-price" id="ticker-price-${coin}">Loading...</span>
                    <span class="ticker-change" id="ticker-change-${coin}">0.00%</span>
                `;
                
                tickerScroll.appendChild(tickerItem);
            });
        }
        
        // Initialize charts
        function initializeCharts() {
            const ctx = document.getElementById('priceChart').getContext('2d');
            priceChart = new Chart(ctx, {
                type: 'line',
                data: {
                    datasets: []
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            type: 'time',
                            time: {
                                unit: 'day'
                            },
                            grid: {
                                color: 'rgba(141, 153, 174, 0.1)'
                            }
                        },
                        y: {
                            beginAtZero: false,
                            grid: {
                                color: 'rgba(141, 153, 174, 0.1)'
                            },
                            ticks: {
                                callback: function(value) {
                                    return '$' + value;
                                }
                            }
                        }
                    },
                    plugins: {
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': $' + context.parsed.y.toFixed(4);
                                }
                            }
                        }
                    }
                }
            });
            
            const customCtx = document.getElementById('customChart').getContext('2d');
            customChart = new Chart(customCtx, {
                type: 'line',
                data: {
                    datasets: []
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            type: 'time',
                            time: {
                                unit: 'day'
                            },
                            grid: {
                                color: 'rgba(141, 153, 174, 0.1)'
                            }
                        },
                        y: {
                            beginAtZero: false,
                            grid: {
                                color: 'rgba(141, 153, 174, 0.1)'
                            },
                            ticks: {
                                callback: function(value) {
                                    return '$' + value;
                                }
                            }
                        }
                    }
                }
            });
            
            // Add sample data to charts
            addSampleChartData();
        }
        
        // Add sample data to charts
        function addSampleChartData() {
            const colors = ['#4cc9f0', '#f72585', '#4361ee', '#7209b7', '#3a0ca3', '#ff9e00'];
            
            // Add sample data to price chart
            monitoredCoins.forEach((coin, index) => {
                if (index < 3) { // Only add first 3 coins to avoid clutter
                    priceChart.data.datasets.push({
                        label: coin,
                        data: generatePriceData(Math.random() * 10 + 0.5, Math.random() * 2, 30),
                        borderColor: colors[index % colors.length],
                        backgroundColor: colors[index % colors.length] + '20',
                        tension: 0.3,
                        pointRadius: 0,
                        fill: true
                    });
                }
            });
            
            priceChart.update();
        }
        
        // Set up event listeners
        function setupEventListeners() {
            // Tab switching
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabName = tab.getAttribute('data-tab');
                    switchTab(tabName);
                });
            });
            
            // Add coin button
            document.getElementById('addCoinBtn').addEventListener('click', addCustomCoin);
            
            // Save API keys button
            document.getElementById('saveApiKeys').addEventListener('click', saveApiKeys);
        }
        
        // Save API keys
        function saveApiKeys() {
            cmcApiKey = document.getElementById('cmcApiKey').value.trim();
            cgApiKey = document.getElementById('cgApiKey').value.trim();
            
            if (cmcApiKey) {
                dataSource = 'CoinMarketCap';
            }
            
            // Save to localStorage
            localStorage.setItem('cmcApiKey', cmcApiKey);
            localStorage.setItem('cgApiKey', cgApiKey);
            
            showNotification('API keys saved successfully', 'success');
            
            // Fetch data with new API keys
            fetchMarketData();
            fetchCoinData();
        }
        
        // Switch tabs
        function switchTab(tabName) {
            // Deactivate all tabs and contents
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            // Activate selected tab and content
            document.querySelector(`.tab[data-tab="${tabName}"]`).classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }
        
        // Add custom coin to watchlist
        function addCustomCoin() {
            const coinInput = document.getElementById('customCoin');
            const coinSymbol = coinInput.value.trim().toUpperCase();
            
            if (!coinSymbol) {
                showNotification('Please enter a coin symbol', 'error');
                return;
            }
            
            if (customCoins.includes(coinSymbol)) {
                showNotification('Coin is already in your watchlist', 'error');
                return;
            }
            
            customCoins.push(coinSymbol);
            renderCustomCoins();
            
            // Add to chart with simulated data
            const colors = ['#4cc9f0', '#f72585', '#4361ee', '#7209b7', '#3a0ca3', '#ff9e00'];
            const color = colors[customChart.data.datasets.length % colors.length];
            
            customChart.data.datasets.push({
                label: coinSymbol,
                data: generatePriceData(Math.random() * 10 + 0.5, Math.random() * 2, 30),
                borderColor: color,
                backgroundColor: color + '20',
                tension: 0.3,
                pointRadius: 0,
                fill: true
            });
            
            customChart.update();
            
            coinInput.value = '';
            showNotification(`${coinSymbol} added to your watchlist`, 'success');
            
            // Try to fetch real data for this coin
            fetchCoinData(coinSymbol);
        }
        
        // Render custom coins list
        function renderCustomCoins() {
            const container = document.getElementById('customCoinsList');
            container.innerHTML = '';
            
            if (customCoins.length === 0) {
                container.innerHTML = '<p>No coins in your watchlist yet. Add some above.</p>';
                return;
            }
            
            customCoins.forEach(coin => {
                const coinData = getCoinData(coin);
                const price = coinData ? coinData.price : (Math.random() * 100 + 0.5).toFixed(4);
                const change = coinData ? coinData.change : (Math.random() * 10 - 5).toFixed(2);
                const isPositive = parseFloat(change) >= 0;
                const prediction = Math.random() > 0.5 ? 'BULLISH' : 'BEARISH';
                
                const coinEl = document.createElement('div');
                coinEl.className = 'coin-card';
                coinEl.innerHTML = `
                    <div class="coin-name">${coin}</div>
                    <div class="coin-price">$${price}</div>
                    <div class="price-change ${isPositive ? 'prediction-bullish' : 'prediction-bearish'}">${isPositive ? '+' : ''}${change}% (24h)</div>
                    <div>Prediction: <span class="${prediction === 'BULLISH' ? 'prediction-bullish' : 'prediction-bearish'}">${prediction}</span></div>
                `;
                container.appendChild(coinEl);
            });
        }
        
        // Start data feed
        function startDataFeed() {
            // Update time every second
            setInterval(() => {
                const now = new Date();
                document.getElementById('updateTime').textContent = now.toUTCString().substring(17, 25);
            }, 1000);
            
            // Update data every 60 seconds
            setInterval(() => {
                fetchMarketData();
                fetchCoinData();
            }, 60000);
            
            // Simulate system self-update every 30 seconds
            setInterval(() => {
                simulateSystemUpdate();
            }, 30000);
        }
        
        // Fetch market data from API
        async function fetchMarketData() {
            try {
                let data;
                
                if (dataSource === 'CoinMarketCap' && cmcApiKey) {
                    // Try CoinMarketCap first if API key is available
                    try {
                        const response = await axios.get('https://pro-api.coinmarketcap.com/v1/global-metrics/quotes/latest', {
                            headers: {
                                'X-CMC_PRO_API_KEY': cmcApiKey
                            }
                        });
                        
                        data = response.data.data;
                        
                        // Update BTC dominance
                        const btcDom = data.btc_dominance;
                        document.getElementById('btcDominanceValue').textContent = btcDom.toFixed(2) + '%';
                        document.getElementById('btcDominanceBar').style.width = btcDom + '%';
                        
                        // Update market cap
                        const marketCap = (data.quote.USD.total_market_cap / 1000000000000).toFixed(2);
                        document.getElementById('totalMarketCap').textContent = '$' + marketCap + 'T';
                        
                        // Update volume
                        const volume = (data.quote.USD.total_volume_24h / 1000000000).toFixed(1);
                        document.getElementById('marketVolume').textContent = '$' + volume + 'B';
                        
                        // Update market sentiment
                        const sentiment = btcDom > 55 ? 'Bullish' : btcDom > 45 ? 'Neutral' : 'Bearish';
                        document.getElementById('marketSentiment').textContent = sentiment;
                        
                        // Update API status
                        document.getElementById('cmcStatus').className = 'api-status-indicator api-status-live';
                        document.getElementById('cmcStatusText').textContent = 'Live';
                        
                        return; // Exit if CoinMarketCap data is successful
                    } catch (error) {
                        console.error('CoinMarketCap API error:', error);
                        // Fall back to CoinGecko if CoinMarketCap fails
                        dataSource = 'CoinGecko';
                    }
                }
                
                // Use CoinGecko as fallback
                const response = await axios.get('https://api.coingecko.com/api/v3/global');
                data = response.data;
                
                // Update BTC dominance
                const btcDom = data.data.market_cap_percentage.btc;
                document.getElementById('btcDominanceValue').textContent = btcDom.toFixed(2) + '%';
                document.getElementById('btcDominanceBar').style.width = btcDom + '%';
                
                // Update market cap
                const marketCap = (data.data.total_market_cap.usd / 1000000000000).toFixed(2);
                document.getElementById('totalMarketCap').textContent = '$' + marketCap + 'T';
                
                // Update volume
                const volume = (data.data.total_volume.usd / 1000000000).toFixed(1);
                document.getElementById('marketVolume').textContent = '$' + volume + 'B';
                
                // Update market sentiment
                const sentiment = btcDom > 55 ? 'Bullish' : btcDom > 45 ? 'Neutral' : 'Bearish';
                document.getElementById('marketSentiment').textContent = sentiment;
                
                // Update API status
                document.getElementById('cgStatus').className = 'api-status-indicator api-status-live';
                document.getElementById('cgStatusText').textContent = 'Live';
                
            } catch (error) {
                console.error('Error fetching market data:', error);
                showNotification('Error updating market data. Using fallback data...', 'error');
                
                // Fallback data
                document.getElementById('btcDominanceValue').textContent = '58.27%';
                document.getElementById('btcDominanceBar').style.width = '58.27%';
                document.getElementById('totalMarketCap').textContent = '$2.36T';
                document.getElementById('marketVolume').textContent = '$108.4B';
                document.getElementById('marketSentiment').textContent = 'Neutral to Bullish';
                
                // Update API status
                document.getElementById('cmcStatus').className = 'api-status-indicator api-status-offline';
                document.getElementById('cmcStatusText').textContent = 'Offline - Using Fallback';
            }
        }
        
        // Fetch coin data from API
        async function fetchCoinData(specificCoin = null) {
            try {
                const coinsToFetch = specificCoin ? [specificCoin] : [...monitoredCoins, ...topCoins];
                
                // Convert symbols to CoinGecko IDs
                const coinIds = coinsToFetch.map(symbol => {
                    const mapping = {
                        'BTC': 'bitcoin',
                        'ETH': 'ethereum',
                        'BNB': 'binancecoin',
                        'SOL': 'solana',
                        'XRP': 'ripple',
                        'DOGE': 'dogecoin',
                        'ADA': 'cardano',
                        'AVAX': 'avalanche-2',
                        'DOT': 'polkadot',
                        'LINK': 'chainlink',
                        'MATIC': 'matic-network',
                        'SHIB': 'shiba-inu',
                        'BCH': 'bitcoin-cash',
                        'LTC': 'litecoin',
                        'XMR': 'monero',
                        'WIF': 'dogwifcoin',
                        'FIL': 'filecoin',
                        'BONK': 'bonk',
                        'TRX': 'tron'
                    };
                    
                    return mapping[symbol] || symbol.toLowerCase();
                }).join(',');
                
                const response = await axios.get(`https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&ids=${coinIds}&price_change_percentage=24h`);
                const data = response.data;
                
                // Update coin data
                data.forEach(coin => {
                    // Map back to symbol
                    const symbolMapping = {
                        'bitcoin': 'BTC',
                        'ethereum': 'ETH',
                        'binancecoin': 'BNB',
                        'solana': 'SOL',
                        'ripple': 'XRP',
                        'dogecoin': 'DOGE',
                        'cardano': 'ADA',
                        'avalanche-2': 'AVAX',
                        'polkadot': 'DOT',
                        'chainlink': 'LINK',
                        'matic-network': 'MATIC',
                        'shiba-inu': 'SHIB',
                        'bitcoin-cash': 'BCH',
                        'litecoin': 'LTC',
                        'monero': 'XMR',
                        'dogwifcoin': 'WIF',
                        'filecoin': 'FIL',
                        'bonk': 'BONK',
                        'tron': 'TRX'
                    };
                    
                    const symbol = symbolMapping[coin.id] || coin.symbol.toUpperCase();
                    coinData[symbol] = {
                        price: coin.current_price.toFixed(4),
                        change: coin.price_change_percentage_24h.toFixed(2)
                    };
                });
                
                // Update ticker
                updateTicker();
                
                // Update monitored coins
                updateMonitoredCoins();
                
                // Update gainers and losers
                updateGainersLosers();
                
                // Update API status
                document.getElementById('cgStatus').className = 'api-status-indicator api-status-live';
                document.getElementById('cgStatusText').textContent = 'Live';
                
            } catch (error) {
                console.error('Error fetching coin data:', error);
                showNotification('Error updating coin data. Using fallback data...', 'error');
                
                // Update API status
                document.getElementById('cgStatus').className = 'api-status-indicator api-status-offline';
                document.getElementById('cgStatusText').textContent = 'Offline - Using Fallback';
                
                // Fallback: Generate random data
                coinsToFetch.forEach(coin => {
                    coinData[coin] = {
                        price: (Math.random() * 100 + 0.5).toFixed(4),
                        change: (Math.random() * 20 - 10).toFixed(2)
                    };
                });
                
                updateTicker();
                updateMonitoredCoins();
                updateGainersLosers();
            }
        }
        
        // Update ticker with real data
        function updateTicker() {
            const tickerScroll = document.getElementById('tickerScroll');
            tickerScroll.innerHTML = '';
            
            topCoins.forEach(coin => {
                const coinInfo = coinData[coin];
                if (coinInfo) {
                    const tickerItem = document.createElement('div');
                    tickerItem.className = 'ticker-item';
                    
                    tickerItem.innerHTML = `
                        <span class="ticker-symbol">${coin}</span>
                        <span class="ticker-price">$${coinInfo.price}</span>
                        <span class="ticker-change ${coinInfo.change >= 0 ? 'price-up' : 'price-down'}">${coinInfo.change >= 0 ? '+' : ''}${coinInfo.change}%</span>
                    `;
                    
                    tickerScroll.appendChild(tickerItem);
                }
            });
            
            // Animate the ticker
            animateTicker();
        }
        
        // Animate the ticker
        function animateTicker() {
            const tickerScroll = document.getElementById('tickerScroll');
            const tickerContainer = document.querySelector('.ticker-container');
            
            // Reset animation
            tickerScroll.style.animation = 'none';
            tickerScroll.offsetHeight; /* trigger reflow */
            
            // Calculate animation duration based on content width
            const contentWidth = tickerScroll.scrollWidth;
            const containerWidth = tickerContainer.offsetWidth;
            const duration = Math.max(30, contentWidth / 25); // Adjust speed as needed
            
            tickerScroll.style.animation = `ticker-scroll ${duration}s linear infinite`;
        }
        
        // Update monitored coins display
        function updateMonitoredCoins() {
            const container = document.getElementById('monitoredCoinsGrid');
            container.innerHTML = '';
            
            monitoredCoins.forEach(coin => {
                const coinInfo = coinData[coin];
                if (!coinInfo) return;
                
                const price = coinInfo.price;
                const change = coinInfo.change;
                const isPositive = parseFloat(change) >= 0;
                
                // Generate AI prediction based on price change
                let prediction, signal, target;
                if (parseFloat(change) > 5) {
                    prediction = 'BULLISH';
                    signal = 'STRONG BUY: Now';
                    target = '10-15% gain expected';
                } else if (parseFloat(change) > 0) {
                    prediction = 'BULLISH';
                    signal = 'BUY: Accumulate';
                    target = '5-10% gain expected';
                } else if (parseFloat(change) > -5) {
                    prediction = 'NEUTRAL';
                    signal = 'HOLD: Wait for signal';
                    target = 'Consolidation phase';
                } else {
                    prediction = 'BEARISH';
                    signal = 'SELL: Avoid';
                    target = 'Further decline likely';
                }
                
                const coinEl = document.createElement('div');
                coinEl.className = 'coin-card';
                coinEl.innerHTML = `
                    <div class="coin-name">${coin}</div>
                    <div class="coin-price">$${price}</div>
                    <div class="price-change ${isPositive ? 'prediction-bullish' : 'prediction-bearish'}">${isPositive ? '+' : ''}${change}% (24h)</div>
                    <div>Prediction: <span class="${prediction === 'BULLISH' ? 'prediction-bullish' : prediction === 'BEARISH' ? 'prediction-bearish' : ''}">${prediction}</span></div>
                    <div class="signal ${prediction === 'BULLISH' ? 'signal-buy' : prediction === 'BEARISH' ? 'signal-sell' : 'signal-hold'}">${signal}</div>
                    <div class="signal signal-hold">Target: ${target}</div>
                `;
                container.appendChild(coinEl);
            });
        }
        
        // Update gainers and losers
        function updateGainersLosers() {
            // Get all coins with changes
            const coinsWithChanges = Object.entries(coinData)
                .map(([symbol, data]) => ({
                    symbol,
                    change: parseFloat(data.change)
                }))
                .filter(coin => !isNaN(coin.change));
            
            // Sort by change
            const sorted = coinsWithChanges.sort((a, b) => b.change - a.change);
            const gainers = sorted.slice(0, 5);
            const losers = sorted.slice(-5).reverse();
            
            // Update gainers
            const gainersContainer = document.getElementById('gainersList');
            gainersContainer.innerHTML = '';
            
            gainers.forEach(coin => {
                const coinEl = document.createElement('div');
                coinEl.className = 'ticker-item';
                coinEl.innerHTML = `
                    <span class="ticker-symbol">${coin.symbol}</span>
                    <span class="ticker-price">${coinData[coin.symbol].price}</span>
                    <span class="ticker-change price-up">+${coin.change.toFixed(2)}%</span>
                `;
                gainersContainer.appendChild(coinEl);
            });
            
            // Update losers
            const losersContainer = document.getElementById('losersList');
            losersContainer.innerHTML = '';
            
            losers.forEach(coin => {
                const coinEl = document.createElement('div');
                coinEl.className = 'ticker-item';
                coinEl.innerHTML = `
                    <span class="ticker-symbol">${coin.symbol}</span>
                    <span class="ticker-price">${coinData[coin.symbol].price}</span>
                    <span class="ticker-change price-down">${coin.change.toFixed(2)}%</span>
                `;
                losersContainer.appendChild(coinEl);
            });
        }
        
        // Get coin data
        function getCoinData(symbol) {
            return coinData[symbol.toUpperCase()];
        }
        
        // Simulate system updates
        function simulateSystemUpdate() {
            showNotification('System auto-update completed. Prediction models refined.', 'success');
            
            // Slightly improve accuracy after update
            const currentAccuracy = parseFloat(document.getElementById('aiAccuracy').textContent);
            document.getElementById('aiAccuracy').textContent = (Math.min(95, currentAccuracy + 0.2)).toFixed(1) + '%';
            
            // Update system update time
            document.getElementById('systemUpdate').textContent = new Date().toLocaleTimeString();
        }
        
        // Update system status
        function updateSystemStatus() {
            // Simulate occasional system issues and self-healing
            setInterval(() => {
                if (Math.random() > 0.8) {
                    // Simulate a minor issue
                    document.getElementById('dataIntegrity').textContent = '99.5%';
                    document.getElementById('dataIntegrity').style.color = '#f72585';
                    
                    // Show notification
                    showNotification('Minor data anomaly detected. Self-healing in progress...', 'error');
                    
                    // Resolve after a delay
                    setTimeout(() => {
                        document.getElementById('dataIntegrity').textContent = '99.9%';
                        document.getElementById('dataIntegrity').style.color = '#4cc9f0';
                        showNotification('Issue resolved. Data integrity restored.', 'success');
                    }, 3000);
                }
            }, 60000);
        }
        
        // Show notification
        function showNotification(message, type) {
            const notification = document.getElementById('notification');
            const messageEl = document.getElementById('notificationMessage');
            
            messageEl.textContent = message;
            notification.className = `notification show ${type}`;
            
            // Hide after 5 seconds
            setTimeout(() => {
                notification.className = 'notification';
            }, 5000);
        }
        
        // Generate simulated price data
        function generatePriceData(basePrice, volatility, points) {
            const data = [];
            let currentPrice = basePrice;
            const now = Date.now();
            const oneDay = 24 * 60 * 60 * 1000;
            
            for (let i = points - 1; i >= 0; i--) {
                const time = now - (i * oneDay);
                const change = (Math.random() - 0.5) * volatility;
                currentPrice = Math.max(0.01, currentPrice + change);
                
                data.push({
                    x: time,
                    y: currentPrice
                });
            }
            
            return data;
        }
    </script>
</body>
</html>
